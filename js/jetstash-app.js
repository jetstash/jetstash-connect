!function(t){function e(){this.$form=t("#jetstash-connect"),this.$error=t("#jetstash-error"),this.options=jetstashConnect,this.state={error:!1,message:"All fields completed successfully.",element:null},this.loadListeners()}e.prototype.loadListeners=function(){var e=this;e.$form.on("submit",function(r){var s=t(this).serialize();r.preventDefault(),e.checkRequired(),e.state.error===!1?(e.$form.find("button.btn").toggle(),e.$error.append("Your form is being submitted..."),t.post(jetstashConnect.ajaxurl,{action:"jetstash_connect",nonce:jetstashConnect.nonce,form:jetstashConnect.form_id,post:s},function(t){t=JSON.parse(t),e.successOutput(t),e.loadCustomEvent("jetstash",t)})):e.errorOutput()})},e.prototype.checkRequired=function(){var e=this;e.clearErrors(),e.$form.find(":input").each(function(){var r,s,o,n,i;if(r=t(this),s=r.attr("required"),o=r.attr("type"),n=r.val(),"undefined"!=typeof s&&s!==!1){if(i=r.siblings("label").text()||r.closest("label").text().trim()||r.attr("name"),""===n||null===n)return e.setStateError(i+" is required.",r),!1;if("checkbox"===o&&!r.is(":checked"))return e.setStateError(i+" is required.",r),!1;if("radio"===o&&!r.is(":checked")&&!r.closest("div.form-group").find(":input").is(":checked"))return e.setStateError(i+" is required.",r),!1;if("email"===o&&!1===e.validateEmail(n))return e.setStateError("Your email is not valid.",r),!1}else e.state.error=!1,e.state.message="All fields complete.",e.state.element=null})},e.prototype.validateEmail=function(t){var e=/\S+@\S+\.\S+/;return e.test(t)},e.prototype.clearErrors=function(){this.$form.find("div.form-group").removeClass("has-error"),this.$error.empty()},e.prototype.setStateError=function(t,e){this.state.error=!0,this.state.message=t,this.state.element=e},e.prototype.errorOutput=function(){this.clearErrors(),null!==this.state.element&&(this.state.element.closest("div.form-group").addClass("has-error"),this.$error.text(this.state.message))},e.prototype.successOutput=function(e){this.clearErrors(),e.success===!0?(t("#jetstash-connect *").fadeOut(200),this.$form.prepend('<p class="jetstash-success">'+this.options.message+"</p>")):(this.$form.find("button.btn").toggle(),this.$error.append(e.message)),("local"===jetstashConnect.environment||"staging"===jetstashConnect.environment)&&console.log(e)},e.prototype.loadCustomEvent=function(e,r){t.event.trigger({type:e,state:r})},t("form#jetstash-connect").length>0&&new e}(jQuery);